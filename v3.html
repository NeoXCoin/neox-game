<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>NeoX Catch — Level 3</title>
<link rel="icon" href="https://neoxcoin.github.io/XNXC.png" />
<style>
  html, body {
    margin: 0;
    padding: 0;
    background: #000;
    overflow: hidden;
    height: 100%;
  }

  /* ===== 開場動畫區 ===== */
  #opening {
    position: fixed;
    inset: 0;
    background: #000;
    z-index: 20;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  #opening video {
    width: 100%;
    height: 100%;
    object-fit: contain;
    background: #000;
  }

  #skipBtn {
    position: absolute;
    bottom: 8%;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0,0,0,0.6);
    color: white;
    border: none;
    border-radius: 12px;
    font-size: 18px;
    padding: 10px 20px;
    cursor: pointer;
    z-index: 25;
  }

  /* ===== 遊戲區 ===== */
  #wrap {
    position: relative;
    width: 100%;
    height: 100dvh;
    overflow: hidden;
    background: black;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  canvas {
    width: auto;
    height: 92vh;
    object-fit: contain;
    display: block;
  }

  /* ===== HUD 介面 ===== */
  .hud {
    position: fixed;
    inset: 0;
    z-index: 50;
    pointer-events: none;
    display: flex;
    flex-direction: column;
  }

  .topbar {
    display: grid;
    grid-template-columns: auto 1fr auto;
    align-items: center;
    gap: 10px;
    padding: 16px 18px;
  }

  .topbar .left,
  .topbar .right {
    pointer-events: auto;
    align-self: center;
  }

  .topbar .center {
    text-align: center;
    pointer-events: none;
  }

  .badge {
    background: rgba(0,0,0,0.6);
    color: white;
    border-radius: 10px;
    padding: 6px 14px;
    font-weight: 700;
    font-size: 16px;
  }

  .btn {
    background: #111a40;
    color: #fff;
    border: none;
    border-radius: 10px;
    padding: 10px 14px;
    font-weight: bold;
    cursor: pointer;
    pointer-events: auto;
  }

  /* ===== 結束畫面 ===== */
  #ending {
    position: fixed;
    inset: 0;
    display: none;
    justify-content: center;
    align-items: center;
    background: rgba(0,0,0,0.8);
    z-index: 100;
    flex-direction: column;
    text-align: center;
    color: white;
  }

  #ending.show {
    display: flex;
  }

  .panel {
    background: rgba(0,0,0,0.6);
    border-radius: 14px;
    padding: 20px 40px;
    backdrop-filter: blur(8px);
  }

  .panel h1 {
    margin: 0 0 14px;
    font-size: 32px;
  }

  .row {
    display: flex;
    justify-content: center;
    gap: 16px;
    margin-top: 12px;
  }

  /* ===== 橫向視窗 ===== */
  @media (orientation: landscape) {
    html, body, #wrap { height: 100dvh; }
    canvas, video {
      height: min(92vh, 720px);
      width: auto;
      object-fit: contain;
    }
  }

  /* ===== 手機窄螢幕 ===== */
  @media (max-width: 600px) {
    .topbar { padding: 10px 14px; }
  }
</style>
</head>

<body>
  <!-- 🔹 開場動畫 -->
  <div id="opening">
    <video id="introVideo" playsinline controls preload="auto">
      <source src="https://neoxcoin.github.io/neox-game/TreasureL3Opening.mp4" type="video/mp4">
    </video>
    <button id="skipBtn">Skip ▶</button>
  </div>

  <!-- 🔹 遊戲畫面 -->
  <div id="wrap">
    <canvas id="gameCanvas"></canvas>

    <!-- 🔹 HUD -->
    <div class="hud">
      <div class="topbar">
        <div class="left"><button class="btn" onclick="goHome()">🏠 Home</button></div>
        <div class="center">
          <span class="badge" id="score">Score: 0</span>
          <span class="badge" id="time">Time: 03:00</span>
          <span class="badge" id="best">Best: 51435</span>
        </div>
        <div class="right"><button class="btn" onclick="pauseGame()">⏸ Pause</button></div>
      </div>
    </div>
  </div>

  <!-- 🔹 結束畫面 -->
  <div id="ending">
    <div class="panel">
      <h1>Game Complete 🎉</h1>
      <p id="finalScore">Score: 0 · Best: 51435</p>
      <div class="row">
        <button class="btn" onclick="replayGame()">↻ Replay</button>
        <button class="btn" onclick="finishGame()">Finish</button>
      </div>
    </div>
  </div>

<script>
  // === 控制開場動畫 ===
  const introVideo = document.getElementById("introVideo");
  const skipBtn = document.getElementById("skipBtn");
  const opening = document.getElementById("opening");
  const ending = document.getElementById("ending");

  skipBtn.onclick = () => startGame();
  introVideo.onended = () => startGame();

  function startGame() {
    opening.style.display = "none";
    console.log("🎮 Game Start");
    // 這裡可放遊戲啟動邏輯
  }

  // === 模擬遊戲分數 ===
  let score = 0;
  let timer = 180; // 3分鐘
  const scoreText = document.getElementById("score");
  const timeText = document.getElementById("time");
  const bestText = document.getElementById("best");

  function updateHUD() {
    scoreText.textContent = `Score: ${score}`;
    let m = String(Math.floor(timer / 60)).padStart(2,"0");
    let s = String(timer % 60).padStart(2,"0");
    timeText.textContent = `Time: ${m}:${s}`;
  }

  // === 模擬遊戲運行 ===
  const gameLoop = setInterval(()=>{
    if(timer > 0){
      timer--;
      score += Math.floor(Math.random()*30);
      updateHUD();
    } else {
      clearInterval(gameLoop);
      showEnd();
    }
  },1000);

  function showEnd(){
    ending.classList.add("show");
    document.getElementById("finalScore").textContent = `Score: ${score} · Best: 51435`;
  }

  function replayGame(){
    location.reload();
  }
  function finishGame(){
    window.location.href = "https://neoxcoin.github.io/neox-game/endgame.html";
  }
  function goHome(){
    window.location.href = "https://neoxcoin.github.io/";
  }
  function pauseGame(){
    alert("⏸ Game Paused (demo only)");
  }
</script>
</body>
</html>