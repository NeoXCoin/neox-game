<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>NeoX Catch Game — Opening</title>
<style>
  html,body{
    margin:0;height:100%;background:#05081A;color:#fff;
    font-family:system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans",Arial,sans-serif;
    overflow:hidden;
  }

  /* ===== Banner ===== */
  #banner{
    position:absolute;inset:0;display:grid;place-items:center;text-align:center;z-index:10;
    background:
      linear-gradient(rgba(5,8,26,.6),rgba(5,8,26,.9)),
      url('https://neoxcoin.github.io/neox-game/TreasureSite%20.JPG') center/cover no-repeat;
    animation:bannerFadeIn 1.6s ease forwards;
  }
  @keyframes bannerFadeIn{from{opacity:0;transform:scale(1.03)}to{opacity:1;transform:scale(1)}}

  .brandline{display:inline-flex;align-items:center;gap:12px;justify-content:center;}
  .coinMark{
    width:clamp(32px,6vw,54px);height:auto;opacity:0;transform:translateY(6px) scale(.95);
    filter:drop-shadow(0 0 10px rgba(255,210,90,.35));
    animation:coinIn .9s ease .15s forwards;
  }
  @keyframes coinIn{to{opacity:1;transform:translateY(0) scale(1)}}

  #banner h1{
    font-size:clamp(28px,6vw,48px);
    letter-spacing:.06em;
    text-shadow:0 0 18px #41b0ff66,0 0 40px #41b0ff33;
  }
  .tagline{
    font-size:clamp(15px,3vw,20px);
    color:#c9d8ff;
    font-weight:500;
    letter-spacing:.05em;
    text-shadow:0 0 10px rgba(100,170,255,.35);
    opacity:0;animation:fadein 1.5s ease .4s forwards;
  }
  @keyframes fadein{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:none}}

  /* ===== Opener video ===== */
  #opener{
    position:absolute;inset:0;display:none;align-items:center;justify-content:center;z-index:11;
    overflow:hidden;
    background:
      linear-gradient(rgba(3,6,23,.6),rgba(5,10,31,.9)),
      url('https://neoxcoin.github.io/neox-game/TreasureSite%20.JPG') center/cover no-repeat;
  }
  #opener video{
    width:100%;height:100%;object-fit:contain;background:#000;
    opacity:0;transition:opacity .6s ease;
  }
  #loadingSpinner{
    position:absolute;inset:0;display:flex;align-items:center;justify-content:center;gap:12px;
    color:#bcd4ff;
  }
  .spinner{
    width:46px;height:46px;border:4px solid #ffffff24;border-top-color:#2b7cff;border-radius:50%;
    animation:spin 1.1s linear infinite;filter:drop-shadow(0 0 8px #2b7cff99);
  }
  @keyframes spin{to{transform:rotate(360deg)}}

  /* ===== Start Game ===== */
  #startLayer{
    position:absolute;inset:0;display:none;place-items:center;background:rgba(5,8,20,.85);
    z-index:13;opacity:0;transition:opacity 1s ease;
  }
  #startLayer.visible{opacity:1;}
  #startBtn{
    background:#2563eb;color:#fff;font-weight:900;font-size:clamp(20px,6vw,36px);
    letter-spacing:.05em;padding:18px 34px;border-radius:14px;cursor:pointer;
    box-shadow:0 0 25px rgba(37,99,235,.6);animation:pop-in 1.1s ease forwards;
  }
  @keyframes pop-in{0%{transform:scale(.85);opacity:0}70%{transform:scale(1.05);opacity:1}100%{transform:scale(1);opacity:1}}
</style>
</head>
<body>

<!-- Banner -->
<section id="banner">
  <div class="brandline">
    <img class="coinMark" src="https://neoxcoin.github.io/neox-emoji-128.png" alt="NeoX Coin" />
    <h1>NeoX Catch Game</h1>
  </div>
  <p class="tagline">Your adventure begins — Catch the NeoX Coins and unlock the treasure!</p>
</section>

<!-- Opening video -->
<section id="opener">
  <div id="loadingSpinner"><div class="spinner"></div><span>Loading opening…</span></div>
  <video id="openerVideo" playsinline webkit-playsinline preload="metadata" muted
    src="https://neoxcoin.github.io/neox-game/NeoXcatchgameOpening_H264.mp4"></video>
</section>

<!-- Start layer -->
<section id="startLayer">
  <div id="startBtn">▶ START GAME</div>
</section>

<!-- Background Music -->
<audio id="bgm" preload="auto" loop
  src="https://neoxcoin.github.io/neox-game/NeoX_OpeningTheme_Cartoon.m4a"
  style="display:none"></audio>

<script>
const banner = document.getElementById('banner');
const opener = document.getElementById('opener');
const video = document.getElementById('openerVideo');
const spinner = document.getElementById('loadingSpinner');
const startLayer = document.getElementById('startLayer');
const startBtn = document.getElementById('startBtn');
const bgm = document.getElementById('bgm');

/* ---- Banner Flow ---- */
setTimeout(() => playBGM(), 500);
setTimeout(() => {
  banner.style.transition = 'opacity 1s ease';
  banner.style.opacity = '0';
  fadeOutBGM();
  setTimeout(() => { banner.style.display = 'none'; startOpening(); }, 1000);
}, 4800);

/* ---- Opening video ---- */
function startOpening(){
  opener.style.display = 'flex';
  video.play().then(() => {
    video.muted = false;
    spinner.style.display='none';
    video.style.opacity='1';
  }).catch(() => {
    spinner.innerHTML = "Tap to play ▶";
    spinner.style.cursor='pointer';
    spinner.onclick=()=>video.play();
  });
}
video.addEventListener('ended', () => {
  fadeOutBGM();
  setTimeout(()=>playBGM(1.0),800);
  setTimeout(()=>showStartLayer(),900);
});

/* ---- Start Layer ---- */
function showStartLayer(){
  startLayer.style.display='grid';
  requestAnimationFrame(()=>startLayer.classList.add('visible'));
}
startBtn.onclick = ()=>{
  fadeOutBGM();
  setTimeout(()=>window.location.href='v1.html',800);
};

/* ---- Background Music (safe autoplay) ---- */
function playBGM(vol=1.0){
  bgm.volume = vol;
  bgm.muted = false;
  bgm.play().catch(()=>{}); // 有手勢時會成功
}
function fadeOutBGM(){
  let v = bgm.volume;
  const fade = setInterval(()=>{
    v -= 0.05;
    if(v<=0){ v=0; clearInterval(fade); bgm.pause(); }
    bgm.volume = v;
  },80);
}
['pointerdown','touchend','click','keydown'].forEach(e=>{
  window.addEventListener(e,()=>{ playBGM(1.0); },{once:true,passive:true});
});
</script>
</body>
</html>