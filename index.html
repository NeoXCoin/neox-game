<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>NeoX Catch Game â€” Opening</title>
<style>
  html,body{margin:0;height:100%;background:#05081A;color:#fff;
    font-family:system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans",Arial,sans-serif;overflow:hidden}

  /* ===== Banner ===== */
  #banner{position:fixed;inset:0;display:grid;place-items:center;text-align:center;z-index:10;
    background:linear-gradient(rgba(5,8,26,.55),rgba(5,8,26,.90)),
               url('https://neoxcoin.github.io/neox-game/TreasureSite%20.JPG') center/cover no-repeat;
    animation:bannerIn 1s ease forwards}
  @keyframes bannerIn{from{opacity:0;transform:scale(1.02)}to{opacity:1;transform:none}}
  .brandline{display:inline-flex;align-items:center;gap:12px;justify-content:center}
  .coin{width:clamp(32px,7vw,60px);filter:drop-shadow(0 0 10px rgba(255,210,90,.35));
    opacity:0;transform:translateY(8px) scale(.96);animation:coinIn .9s ease .15s forwards}
  @keyframes coinIn{to{opacity:1;transform:translateY(0) scale(1)}}
  h1{margin:.2em 0 .3em;font-size:clamp(28px,6vw,48px);letter-spacing:.06em;
    text-shadow:0 0 18px #41b0ff66,0 0 40px #41b0ff33;opacity:0;transform:translateY(8px);
    animation:fadeIn .9s ease .3s forwards}
  .tag{max-width:min(900px,90vw);margin:0 auto;line-height:1.7;font-size:clamp(15px,3.4vw,20px);
    color:#c9d8ff;opacity:0;transform:translateY(8px);animation:fadeIn 1s ease .5s forwards}
  @keyframes fadeIn{to{opacity:1;transform:none}}

  /* ===== Opener video layer ===== */
  #opener{position:fixed;inset:0;display:none;align-items:center;justify-content:center;z-index:11;
    background:linear-gradient(rgba(3,6,23,.60),rgba(5,10,31,.90)),
               url('https://neoxcoin.github.io/neox-game/TreasureSite%20.JPG') center/cover no-repeat}
  #openerVideo{width:100%;height:100%;object-fit:contain;background:#000;opacity:0;
    transition:opacity .6s ease, filter .8s ease;filter:brightness(1)}
  #loading{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;gap:12px;color:#bcd4ff}
  .sp{width:46px;height:46px;border:4px solid #ffffff24;border-top-color:#2b7cff;border-radius:50%;
    animation:spin 1.1s linear infinite;filter:drop-shadow(0 0 8px #2b7cff99)}
  @keyframes spin{to{transform:rotate(360deg)}}

  /* æ§åˆ¶éµï¼ˆPlay with sound / Skipï¼‰ */
  .vctrl{position:absolute;left:50%;bottom:calc(10% + env(safe-area-inset-bottom));
    transform:translateX(-50%);display:flex;gap:12px;flex-wrap:wrap;justify-content:center}
  .vctrl button{background:#1f2a5a;border:0;color:#fff;font-weight:800;letter-spacing:.02em;
    padding:12px 16px;border-radius:12px;box-shadow:0 6px 18px rgba(43,124,255,.35);cursor:pointer}
  #btnPlaySound{background:#2563eb}
  /* è‡ªå‹•æ·¡å‡º */
  .vctrl.fadeout{opacity:0;transition:opacity 1.2s ease;pointer-events:none}
  
  /* æ‰‹æ©Ÿæ©«å‘ï¼šæ§åˆ¶éµæ©«å‘æ’ã€ä½ç½®ç•¥å‡é«˜ */
@media (orientation: landscape) {
  .vctrl {
    flex-direction: row;
    gap: 18px;
    bottom: calc(6% + env(safe-area-inset-bottom));
  }
}

/* æ‰‹æ©Ÿç›´å‘ï¼šæ§åˆ¶éµå‚ç›´æ’ï¼ˆé è¨­æ¨£å¼çš„è£œå……ï¼‰ */
@media (orientation: portrait) {
  .vctrl {
    flex-direction: row;
    gap: 10px;
    bottom: calc(10% + env(safe-area-inset-bottom));
  }
}

  /* ===== Start layer ===== */
  #startLayer{position:fixed;inset:0;display:none;place-items:center;background:rgba(5,8,20,.85);
    z-index:13;opacity:0;transition:opacity .9s ease}
  #startLayer.visible{opacity:1}
  #startBtn{background:#2563eb;color:#fff;font-weight:900;letter-spacing:.05em;
    padding:18px 34px;border-radius:14px;cursor:pointer;user-select:none;
    font-size:clamp(20px,6vw,36px);box-shadow:0 0 25px rgba(37,99,235,.6);animation:pop .9s ease forwards}
  @keyframes pop{from{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}

  /* FXï¼ˆç™½é–ƒ + NeoX Coin çˆ†å…‰ï¼‰ */
  #fx{position:fixed;inset:0;display:none;place-items:center;pointer-events:none;z-index:12}
  #fx .flash{position:absolute;inset:0;background:#fff;opacity:0}
  #fx .pulse{position:absolute;left:50%;top:50%;width:130px;height:130px;transform:translate(-50%,-50%) scale(.3);
    background:url('https://neoxcoin.github.io/neox-emoji-128.png') center/contain no-repeat;
    filter:drop-shadow(0 0 20px rgba(80,150,255,.8)) drop-shadow(0 0 40px rgba(43,124,255,.4));opacity:.95}
  .run .flash{animation:fx-flash .52s ease-out forwards}
  .run .pulse{animation:fx-burst .9s ease-out forwards}
  @keyframes fx-flash{0%{opacity:0}20%{opacity:1}100%{opacity:0}}
  @keyframes fx-burst{0%{transform:translate(-50%,-50%) scale(.3);opacity:1}
                      60%{transform:translate(-50%,-50%) scale(6);opacity:.45}
                      100%{transform:translate(-50%,-50%) scale(8);opacity:0}}
</style>
</head>
<body>

<!-- Banner -->
<section id="banner">
  <div class="brandline">
    <img class="coin" src="https://neoxcoin.github.io/neox-emoji-128.png" alt="NeoX Coin" />
    <h1>NeoX Catch Game</h1>
  </div>
  <p class="tag">Your adventure begins â€” Catch the NeoX Coins and unlock the treasure!</p>
</section>

<!-- Opener -->
<section id="opener" aria-label="Opening">
  <div id="loading"><div class="sp"></div><span>Loading openingâ€¦</span></div>
  <video id="openerVideo" playsinline webkit-playsinline muted autoplay preload="auto"></video>
  <div class="vctrl" id="openerControls" hidden>
    <button id="btnPlaySound">â–¶ Play with sound</button>
    <button id="btnSkip">â­ Skip</button>
  </div>
</section>

<!-- Start -->
<section id="startLayer"><button id="startBtn">â–¶ START GAME</button></section>

<!-- Transition FX -->
<div id="fx"><div class="flash"></div><div class="pulse"></div></div>

<!-- Short transition BGM (plays when Start is pressed) -->
<audio id="startBGM" preload="auto"
  src="https://neoxcoin.github.io/neox-game/NeoX_OpeningTheme_Cartoon.m4a" style="display:none"></audio>

<script>
/* Elements */
const banner = document.getElementById('banner');
const opener = document.getElementById('opener');
const video  = document.getElementById('openerVideo');
const loading= document.getElementById('loading');
const ctrls  = document.getElementById('openerControls');
const btnPlay= document.getElementById('btnPlaySound');
const btnSkip= document.getElementById('btnSkip');
const start  = document.getElementById('startLayer');
const startBtn=document.getElementById('startBtn');
const fx     = document.getElementById('fx');
const startBGM = document.getElementById('startBGM');

/* ---------- Banner â†’ Opener ---------- */
setTimeout(()=>{
  banner.style.transition='opacity .9s ease';
  banner.style.opacity='0';
  setTimeout(()=>{ banner.style.display='none'; startOpening(); }, 900);
}, 1800);

/* ---------- Responsive fit ---------- */
function fitVideo(){
  const r=(video.videoWidth||16)/(video.videoHeight||9);
  const s=innerWidth/innerHeight;
  video.style.objectFit = Math.abs(r-s) < 0.18 ? 'cover' : 'contain';
}
video.addEventListener('loadedmetadata', fitVideo);
addEventListener('resize', fitVideo, {passive:true});

/* ---------- Opener flow ---------- */
let ctrlFadeTimer;
function scheduleControlsFade(ms=6000){ clearTimeout(ctrlFadeTimer); ctrlFadeTimer=setTimeout(()=>ctrls.classList.add('fadeout'), ms); }
function fadeControlsSoon(delay=600){ clearTimeout(ctrlFadeTimer); setTimeout(()=>ctrls.classList.add('fadeout'), delay); }
function showControlsAndArmTimer(ms=6000){ ctrls.hidden=false; ctrls.classList.remove('fadeout'); scheduleControlsFade(ms); }

function startOpening(){
  opener.style.display='flex';
  video.src='https://neoxcoin.github.io/neox-game/NeoXcatchgameOpening_H264.mp4';
  video.muted=true;
  video.play().then(()=>{
    loading.style.display='none';
    video.style.opacity='1';
    showControlsAndArmTimer(6000);
  }).catch(()=>{
    showControlsAndArmTimer(6000);
  });
}

btnPlay.addEventListener('click', async ()=>{
  try{ if (video.paused) await video.play(); video.muted=false; btnPlay.textContent='ğŸ”Š Sound on'; btnPlay.disabled=true; }catch(e){}
  fadeControlsSoon(600);  // æœ‰æŒ‰ä¹Ÿæœƒæ·¡å‡º
});

btnSkip.addEventListener('click', ()=>{
  fadeControlsSoon(0);    // ç«‹å³æ·¡å‡º
  try{ video.pause(); }catch(e){}
  playFX();
  setTimeout(showStart, 900);
});

video.addEventListener('playing', ()=>{ loading.style.display='none'; video.style.opacity='1'; scheduleControlsFade(6000); });
video.addEventListener('ended', ()=>{
  video.style.filter='brightness(1.25)'; // äº®ä¸€é»
  playFX();
  setTimeout(showStart, 900);
});

/* ---------- Start Layer ---------- */
function showStart(){ opener.style.display='none'; start.style.display='grid'; requestAnimationFrame(()=>start.classList.add('visible')); }

startBtn.addEventListener('click', ()=>{
  // æ’­çŸ­éå ´ BGMï¼Œå†è·³ v1.html
  try{ startBGM.currentTime=0; startBGM.volume=1; startBGM.muted=false; startBGM.play().catch(()=>{});}catch(e){}
  setTimeout(()=>{ window.location.href='v1.html'; }, 800);
});

/* ---------- FX ---------- */
function playFX(){
  fx.style.display='grid';
  fx.classList.remove('run');
  requestAnimationFrame(()=>fx.classList.add('run'));
  setTimeout(()=>{ fx.style.display='none'; }, 950);
}

/* ä¸€æ¬¡æ‰‹å‹¢å¯åŒæ™‚è§£é–è²éŸ³ï¼ˆä¿éšªï¼‰ */
['pointerdown','touchend','click','keydown'].forEach(evt=>{
  window.addEventListener(evt, async ()=>{
    if (video.muted) { try{ if (video.paused) await video.play(); }catch(e){} }
  }, { once:true, passive:true });
});
</script>
</body>
</html>