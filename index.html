<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>NeoX Treasure – Start</title>
<style>
  :root{ --bg:#060a1a; --panel:#0b1030; --brand:#26a8ff; }
  html,body{margin:0;height:100%;background:var(--bg);color:#fff;font-family:system-ui,-apple-system,Segoe UI,Roboto}
  /* 整頁容器 */
  .shell{position:fixed;inset:0;overflow:hidden;padding-bottom:env(safe-area-inset-bottom)}
  /* 開場動畫層 */
  #intro{position:absolute;inset:0;display:grid;place-items:center;z-index:10;
         background:radial-gradient(1000px 700px at 50% 25%, #0b1450 0%, #070b25 60%, #040713 100%);}
  #intro .box{position:relative;display:flex;flex-direction:column;align-items:center;gap:14px}
  #logoX{font-weight:900;font-size:clamp(28px,9vw,56px);letter-spacing:.12em;margin:0;
         text-shadow:0 0 18px #41b0ff66,0 0 42px #41b0ff33;opacity:0;transform:translateY(10px) scale(.98);
         transition:opacity .7s, transform .7s;}
  #powered{opacity:.0;transition:opacity .8s .4s}
  #play{border:0;border-radius:12px;padding:12px 18px;font-weight:800;letter-spacing:.02em;
        background:#2563eb;box-shadow:0 12px 28px #2563eb55;color:#fff;cursor:pointer}
  /* 星星背景 */
  #stars{position:absolute;inset:0;opacity:.7}
  /* 遊戲區（iframe 全屏） */
  #stage{position:absolute;inset:0}
  iframe{position:absolute;inset:0;width:100%;height:100%;border:0;display:block;background:#000}
  /* 角落小字 */
  .credit{position:fixed;left:12px;bottom:calc(10px + env(safe-area-inset-bottom));opacity:.55;font-size:12px}
</style>
</head>
<body>
<div class="shell">
  <!-- 開場動畫 -->
  <div id="intro" role="dialog" aria-label="Start screen">
    <canvas id="stars"></canvas>
    <div class="box">
      <h1 id="logoX">NEOX</h1>
      <div id="powered">Powered by NeoX</div>
      <button id="play" aria-label="Play Game">Play Game</button>
    </div>
  </div>

  <!-- 遊戲容器（按 Play 後載入 v1.html） -->
  <div id="stage" aria-hidden="true">
    <iframe id="gameFrame" src="about:blank" allow="autoplay; fullscreen"></iframe>
  </div>

  <div class="credit">© NeoX</div>
</div>

<script>
/* ===== 開場動畫：星空粒子 ===== */
const intro=document.getElementById('intro');
const logo=document.getElementById('logoX');
const powered=document.getElementById('powered');
const stars=document.getElementById('stars');
const sctx=stars.getContext('2d');
function fit(){ stars.width=innerWidth; stars.height=innerHeight; }
fit(); addEventListener('resize',fit);
const dots=[...Array(100)].map(()=>({x:Math.random()*stars.width,y:Math.random()*stars.height,z:0.6+Math.random()*1.2}));
(function loop(){
  sctx.fillStyle='rgba(5,10,25,.35)'; sctx.fillRect(0,0,stars.width,stars.height);
  dots.forEach(d=>{ d.y+=d.z*0.7; if(d.y>stars.height) d.y=0; sctx.beginPath(); sctx.arc(d.x,d.y,d.z*1.1,0,6.28); sctx.fillStyle='rgba(120,190,255,.85)'; sctx.fill();});
  requestAnimationFrame(loop);
})();
requestAnimationFrame(()=>{ logo.style.opacity='1'; logo.style.transform='translateY(0) scale(1)'; powered.style.opacity='0.9'; });

/* ===== 點擊 Play → 載入 v1 ===== */
const frame=document.getElementById('gameFrame');
document.getElementById('play').onclick=()=>{
  // 淡出開場層
  intro.style.transition='opacity .6s'; intro.style.opacity='0';
  setTimeout(()=>intro.remove(),600);
  // 載入第一關
  frame.src='v1.html';
};

/* ===== 多關卡訊息（留作之後自動進入 v2/v3 / 播 End Game） ===== */
let level=1,total=0;
window.addEventListener('message',(e)=>{
  const m=e.data||{};
  if(m.type==='levelComplete'){
    total += (m.levelScore||0);
    level++;
    if(level===2) frame.src='v2.html';
    else if(level===3) frame.src='v3.html';
    else {
      // （可選）全部通關 → 播 End Game 影片：之後加
      // showEndGame();
    }
  }
});
</script>
</body>
</html>