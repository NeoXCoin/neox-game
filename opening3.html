<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>NeoX Catch â€” Opening 3</title>
<style>
  :root{
    --pad: clamp(10px, 3.5vw, 18px);
  }
  html,body{
    margin:0;
    height:100%;
    background:#000;
    color:#fff;
    font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "PingFang TC", "Noto Sans", Arial, sans-serif;
    overflow:hidden;
  }

  /* åŒ…è¦†å±¤ï¼šç”¨ fixed + dvh/svh é¿å… iOS æ©«å‘ä½ç½®ä¸‹ç§» */
  #wrap{
    position:fixed;
    inset:0;
    display:grid;
    place-items:center;
    /* å…ˆé¡¯ç¤ºå›ºå®šåœ–ç‰‡ï¼Œé¿å…é»‘å± */
    background:#000 url('PhotoOpening3.PNG') center / contain no-repeat;
    /* é«˜åº¦å…¼å®¹ï¼š */
    height:100vh;          /* fallback */
    height:100svh;         /* iOS 15+ */
    height:100dvh;         /* ç¾ä»£ç€è¦½å™¨ */
  }

  /* å½±ç‰‡ï¼šç¶­æŒåŸæ¯”ä¾‹ã€ä¸è£åˆ‡ä¸æ”¾å¤§ */
  video{
    position:absolute;
    inset:0;
    width:100%;
    height:100%;
    object-fit:contain; /* ğŸ‘ˆ ä¿æŒæ¯”ä¾‹ */
    background:#000 url('PhotoOpening3.PNG') center / contain no-repeat; /* poster ä¿éšª */
    border-radius:0;
    opacity:0;                               /* è¼‰å…¥å¥½å†æ·¡å…¥ */
    transition:opacity .4s ease;
  }

  /* åº•éƒ¨æ–‡å­—ï¼‹æŒ‰éˆ•å±¤ */
  .overlay{
    position:absolute;
    inset:0;
    display:flex;
    flex-direction:column;
    justify-content:flex-end;
    align-items:center;
    text-align:center;
    background:linear-gradient(transparent 55%, rgba(0,0,0,.7));
    padding-bottom:calc(var(--pad) + env(safe-area-inset-bottom));
  }

  h1{
    margin:0 0 8px;
    font-size:clamp(22px, 5.8vw, 36px);
    font-weight:900;
    text-shadow:0 0 18px rgba(65,176,255,.4);
  }
  p{
    margin:0 0 14px;
    font-size:clamp(13px, 3.5vw, 16px);
    color:#cfe0ff;
  }

  .btnrow{
    display:flex;
    gap:10px;
    flex-wrap:nowrap;         /* ç›´å‘ä¹Ÿä¿æŒåŒä¸€è¡Œ */
    justify-content:center;
  }
  button{
    border:0;
    border-radius:12px;
    padding:10px 14px;
    font-weight:800;
    letter-spacing:.02em;
    color:#fff;
    background:#1f2a5a;
    box-shadow:0 8px 22px rgba(43,124,255,.28), inset 0 0 0 1px rgba(255,255,255,.08);
    cursor:pointer;
  }
  .primary{ background:#2b7cff; }

  /* æ©«å‘ä¹Ÿå›ºå®šåœ¨åŒä¸€æ°´å¹³ï¼Œç¨å¾®æŠŠåº•éƒ¨é–“è·æ‹‰è¿‘ */
  @media (orientation:landscape){
    .overlay{ padding-bottom:calc(10px + env(safe-area-inset-bottom)); }
    .btnrow{ gap:12px; }
  }
</style>
</head>
<body>
  <section id="wrap">
    <video id="openerVideo"
      src="TreasureL3Opening.mp4"
      poster="PhotoOpening3.PNG"
      preload="auto"
      muted
      playsinline
      webkit-playsinline
    ></video>

    <div class="overlay">
      <h1>Treasure Journey</h1>
      <p>Watch the short opening, or skip and start the level.</p>
      <div class="btnrow">
        <button id="btnSound">ğŸ”ˆ Play with sound</button>
        <button id="btnStart" class="primary">â–¶ Start Play</button>
        <button id="btnSkip">â­ Skip</button>
      </div>
    </div>
  </section>

<script>
const video   = document.getElementById('openerVideo');
const btnSound= document.getElementById('btnSound');
const btnStart= document.getElementById('btnStart');
const btnSkip = document.getElementById('btnSkip');

/* 1) é¿å…è¼‰å…¥é»‘å±ï¼šposter ç«‹å³é¡¯ç¤ºï¼Œç­‰æœ‰ç•«é¢å†æ·¡å…¥ */
function reveal(){ video.style.opacity = '1'; }
video.addEventListener('loadeddata', reveal);
video.addEventListener('loadedmetadata', reveal);

/* 2) iOS éœ€è¦ä¸€æ¬¡äº’å‹•æ‰å¯æ’­æ”¾/é–‹è² */
let audioCtx;
function ensureAudio(){
  if(!audioCtx){ audioCtx = new (window.AudioContext||window.webkitAudioContext)(); }
}

btnStart.addEventListener('click', async ()=>{
  try{ await video.play(); }catch(e){}
});

btnSound.addEventListener('click', async ()=>{
  ensureAudio();
  try{
    await audioCtx.resume();
    if(video.paused) await video.play();
    video.muted = false;
    btnSound.textContent = 'ğŸ”Š Sound on';
    btnSound.disabled = true;
  }catch(e){}
});

btnSkip.addEventListener('click', ()=>{
  try{ video.pause(); }catch(e){}
  location.href = 'v3.html';          // è·³å»ç¬¬ä¸‰é—œ
});

/* 3) æ’­å®Œè‡ªå‹•é€²å…¥ v3.html */
video.addEventListener('ended', ()=> location.href='v3.html');

/* ä¿éšªï¼šç¬¬ä¸€æ¬¡è§¸ç¢°å°±è§£é–æ’­æ”¾ï¼Œä»ç¶­æŒåŸæ¯”ä¾‹ */
['pointerdown','touchend','click','keydown'].forEach(evt=>{
  window.addEventListener(evt, async ()=>{
    if(video.paused){
      try{ await video.play(); }catch(e){}
    }
  }, { once:true, passive:true });
});
</script>
</body>
</html>