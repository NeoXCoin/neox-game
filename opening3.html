<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>NeoX Catch ‚Äî Opening 3</title>
<style>
  :root { --pad: clamp(10px, 3.5vw, 18px); }

  html,body{
    margin:0;height:100%;
    background:#000;color:#fff;
    font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"PingFang TC","Noto Sans",Arial,sans-serif;
    overflow:hidden;
  }

  #wrap{
    position:fixed;inset:0;display:grid;place-items:center;
    background:#000 url('PhotoOpening3.PNG') center / contain no-repeat;
    height:100vh;height:100svh;height:100dvh;
    opacity:1;transition:opacity .8s ease;
  }
  #wrap.fadeout { opacity:0; pointer-events:none; }

  video{
    position:absolute;inset:0;width:100%;height:100%;
    object-fit:contain;object-position:center center;
    background:#000 url('PhotoOpening3.PNG') center / contain no-repeat;
    border-radius:0;opacity:0;transition:opacity .4s ease;
  }

  .overlay{
    position:absolute;inset:0;display:flex;flex-direction:column;
    justify-content:flex-end;align-items:center;text-align:center;
    background:linear-gradient(transparent 55%, rgba(0,0,0,.7));
    padding-bottom:calc(var(--pad) + env(safe-area-inset-bottom));
  }

  h1{margin:0 0 8px;font-size:clamp(22px,5.8vw,36px);font-weight:900;text-shadow:0 0 18px rgba(65,176,255,.4);}
  p{margin:0 0 14px;font-size:clamp(13px,3.5vw,16px);color:#cfe0ff;}

  .btnrow{display:flex;gap:10px;flex-wrap:nowrap;justify-content:center;}
  button{
    border:0;border-radius:12px;padding:10px 14px;
    font-weight:800;letter-spacing:.02em;color:#fff;
    background:#1f2a5a;
    box-shadow:0 8px 22px rgba(43,124,255,.28),inset 0 0 0 1px rgba(255,255,255,.08);
    cursor:pointer;transition:transform .15s ease;
  }
  button:active{transform:scale(0.95);}
  .primary{background:#2b7cff;}
  @media (orientation:landscape){
    .overlay{padding-bottom:calc(10px + env(safe-area-inset-bottom));}
    .btnrow{gap:12px;}
  }
</style>
</head>
<body>
<section id="wrap">
  <video id="openerVideo"
    src="TreasureL3Opening.mp4"
    poster="PhotoOpening3.PNG"
    preload="auto" muted playsinline webkit-playsinline></video>

  <div class="overlay">
    <h1>Treasure Journey</h1>
    <p>Watch the short opening, or skip and start the level.</p>
    <div class="btnrow">
      <button id="btnSound">üîà Play with sound</button>
      <button id="btnStart" class="primary">‚ñ∂ Start Play</button>
      <button id="btnSkip">‚è≠ Skip</button>
    </div>
  </div>
</section>

<script>
const video   = document.getElementById('openerVideo');
const wrap    = document.getElementById('wrap');
const btnSound= document.getElementById('btnSound');
const btnStart= document.getElementById('btnStart');
const btnSkip = document.getElementById('btnSkip');

/* È°ØÁ§∫ÂΩ±Áâá */
function reveal(){ video.style.opacity = '1'; }
video.addEventListener('loadeddata', reveal);
video.addEventListener('loadedmetadata', reveal);

/* iOS ËÅ≤Èü≥Ëß£Èéñ */
let audioCtx;
function ensureAudio(){
  if(!audioCtx){ audioCtx = new (window.AudioContext||window.webkitAudioContext)(); }
}

/* ÊåâÈàïÂäüËÉΩ */
btnStart.addEventListener('click', ()=>goNext());
btnSkip.addEventListener('click', ()=>goNext());

btnSound.addEventListener('click', async ()=>{
  ensureAudio();
  try{
    await audioCtx.resume();
    if(video.paused) await video.play();
    video.muted = false;
    btnSound.textContent = 'üîä Sound on';
    btnSound.disabled = true;
  }catch(e){}
});

/* ÂΩ±ÁâáËá™ÂãïÊí≠ÊîæËàáÁµêÊùü */
video.play().catch(()=>{});
video.addEventListener('ended', ()=>goNext());

/* ‰∫îÁßíÂæåËá™ÂãïÊ∑°Âá∫ */
let autoTimer = setTimeout(goNext, 5000);

function goNext(){
  clearTimeout(autoTimer);
  wrap.classList.add('fadeout');
  setTimeout(()=>location.href='v3.html', 900);
}

/* Èò≤Ê≠¢Á¨¨‰∏ÄÊ¨°ÈªûÊìä‰∏çÊí≠Êîæ */
['pointerdown','touchend','click','keydown'].forEach(evt=>{
  window.addEventListener(evt, async ()=>{
    if(video.paused){ try{ await video.play(); }catch(e){} }
  }, { once:true, passive:true });
});
</script>
</body>
</html>