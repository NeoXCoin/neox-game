<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>NeoX Catch â€“ Level 2</title>
<style>
  html, body {
    margin: 0;
    padding: 0;
    overflow: hidden;
    height: 100%;
    background: black;
  }

  /* é–‹å ´å‹•ç•« */
  #introVideo {
    position: fixed;
    top: 0; left: 0;
    width: 100vw;
    height: 100vh;
    object-fit: cover;
    z-index: 5;
  }

  /* èƒŒæ™¯å½±ç‰‡ */
  #bgVideo {
    position: fixed;
    top: 0; left: 0;
    width: 100vw;
    height: 100vh;
    object-fit: cover;
    z-index: 0;
  }

  /* éŠæˆ² Canvas */
  #gameCanvas {
    position: fixed;
    top: 0; left: 0;
    width: 100vw;
    height: 100vh;
    z-index: 1;
  }

  /* HUD (åˆ†æ•¸ / æ™‚é–“) */
  #hud {
    position: fixed;
    top: 10px;
    left: 50%;
    transform: translateX(-50%);
    color: white;
    font-family: Arial, sans-serif;
    font-weight: bold;
    z-index: 3;
    text-shadow: 0 0 8px #000;
  }

  /* æ·¡å‡ºå‹•ç•« */
  .fade-out {
    opacity: 0;
    transition: opacity 1s ease;
  }
</style>
</head>
<body>

<!-- ğŸ¬ é–‹å ´å‹•ç•« -->
<video id="introVideo" autoplay muted playsinline>
  <source src="https://neoxcoin.github.io/neox-game/CatchCoinL2.mp4" type="video/mp4">
</video>

<!-- ğŸŒŒ èƒŒæ™¯å½±ç‰‡ -->
<video id="bgVideo" autoplay muted loop playsinline>
  <source src="https://neoxcoin.github.io/neox-game/CatchCoinL2BackGround%20.mp4" type="video/mp4">
</video>

<!-- ğŸ® éŠæˆ² Canvas -->
<canvas id="gameCanvas"></canvas>

<!-- ğŸ§­ HUD -->
<div id="hud">
  <div>Score: <span id="score">0</span></div>
  <div>Time: <span id="time">03:00</span></div>
</div>

<script>
// é–‹å ´å‹•ç•«æ’­æ”¾å®Œç•¢å¾Œå•Ÿå‹•éŠæˆ²
const intro = document.getElementById('introVideo');
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

function resizeCanvas(){
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
resizeCanvas();
window.addEventListener('resize', resizeCanvas);

// ğŸ”„ é–‹å ´å½±ç‰‡å®Œçµå¾Œæ·¡å‡º
intro.addEventListener('ended', ()=>{
  intro.classList.add('fade-out');
  setTimeout(()=>{
    intro.remove();
    startGame();
  },1000);
});

// â­ åˆå§‹åŒ–é–ƒçˆæ˜Ÿæ˜Ÿ
const STAR_COUNT = 70;
const stars = Array.from({length: STAR_COUNT}, () => {
  const period = 2500 + Math.random() * 2000;
  return {
    x: Math.random(),
    y: Math.random()*0.55,
    r: 0.7 + Math.random()*1.8,
    base: 0.25 + Math.random()*0.35,
    amp: 0.35 + Math.random()*0.50,
    t0: Math.random()*4000,
    period
  };
});
function drawTwinkle(nowMS){
  const w=canvas.width, h=canvas.height;
  const t=nowMS;
  ctx.save();
  ctx.globalCompositeOperation='lighter';
  for(const s of stars){
    const cx=s.x*w, cy=s.y*h;
    const phase=((t+s.t0)%s.period)/s.period;
    const tw=(Math.sin(phase*Math.PI*2)+1)*0.5;
    const alpha=s.base+s.amp*tw;
    const r=s.r;
    const g=ctx.createRadialGradient(cx,cy,0,cx,cy,r*3);
    g.addColorStop(0,`rgba(255,255,255,${alpha})`);
    g.addColorStop(1,`rgba(255,255,255,0)`);
    ctx.fillStyle=g;
    ctx.beginPath(); ctx.arc(cx,cy,r*3,0,Math.PI*2); ctx.fill();
    ctx.globalAlpha=Math.min(1,alpha+0.15);
    ctx.beginPath(); ctx.arc(cx,cy,r*0.6,0,Math.PI*2);
    ctx.fillStyle='#fff'; ctx.fill();
    ctx.globalAlpha=1;
  }
  ctx.restore();
}

// ğŸ® éŠæˆ²åˆå§‹åŒ–ï¼ˆä½ å¯ä»¥å¾ v1 copy éä¾†ä¸»è¦é‚è¼¯ï¼‰
let startTime = null;
function startGame(){
  startTime = performance.now();
  requestAnimationFrame(loop);
}

// ğŸ•¹ï¸ ä¸»å¾ªç’°
function loop(now){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  drawTwinkle(now); // æ˜Ÿæ˜Ÿé–ƒçˆ
  // TODO: åœ¨é€™è£¡åŠ å…¥ä½ çš„ v1 éŠæˆ²é‚è¼¯ï¼ˆæ‰è½ coin / å¯¶ç®±ï¼‰
  requestAnimationFrame(loop);
}
</script>

</body>
</html>