<!DOCTYPE html>
<html lang="en">
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>NeoX Game (iframe)</title>
<style>
  body {
    margin: 0;
    background: #0a0b1f;
    display: grid;
    place-items: center;
    height: 100vh;
    font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"PingFang TC","Noto Sans",Arial,sans-serif;
    color: #fff;
  }
  iframe {
    width: min(92vw, 440px);
    aspect-ratio: 9/16;
    border: 0;
    border-radius: 16px;
    box-shadow: 0 10px 40px rgba(0,0,0,.45);
  }
  .scorebox {
    position: fixed;
    bottom: 10px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(255,255,255,.08);
    border-radius: 10px;
    padding: 6px 14px;
    font-weight: 800;
    font-size: 14px;
    box-shadow: 0 4px 10px rgba(0,0,0,.3);
    backdrop-filter: blur(4px);
  }
</style>

<!-- ðŸŽ® èµ·é»žï¼šæ•´å€‹éŠæˆ²æµç¨‹å…¥å£ -->
<iframe id="game" src="index.html" allow="gamepad *"></iframe>
<div class="scorebox" id="scoreBox">Last Score: 0</div>

<script>
const APPKEY='neox_iframe_v1_scores';
const box=document.getElementById('scoreBox');
const state=(()=>{try{return JSON.parse(localStorage.getItem(APPKEY)||'{}')}catch(_){return{}}})();
function save(){ localStorage.setItem(APPKEY, JSON.stringify(state)); }
function showLast(){ box.textContent='Last Score: ' + (state.last||0); }
showLast();

/* å­é é€šè¨Šå”è­° */
const frame=document.getElementById('game');
window.addEventListener('message',(e)=>{
  const m=e.data||{};
  if(m.type==='NX_GOTO' && m.next){ frame.src=m.next; }
  if(m.type==='NX_CARRY'){ box.textContent='Score: ' + Math.floor(m.score||0); }
  if(m.type==='NX_GAME_CLEARED'){
    state.last=Math.floor(m.total||m.score||0); save(); showLast();
    if(m.next) frame.src=m.next;
  }
});
</script>
</html>